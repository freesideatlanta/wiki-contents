The vectorized version of Tam's sketch
